---
layout: post
title:  马尔科夫过程
category: [随机过程] 
hide: true
description: 这篇博文主要介绍随机变量的条件分布特征
---

## 介绍

我们有一个随机过程$$X_t$$，如果假设对于所有的$$t = 1,2,\cdots n,X_t$$都相互独立也许假设过于强烈。如果我们假设$$X_n$$只与$$n-1$$时刻的状态有关，那么我们称该随机过程为马尔科夫过程

### 定义
令$$\{X_n,t=1,2,\cdots\}$$为一个随机过程，其$$X$$的取值范围为有限或可数个数，若非特意指出，我们使用非负整数$$\{0,1,2,\cdots\}$$表示这些。如果$$X_n=i$$，则代表在$$n$$时期，状态为$$i$$。若随机过程在任意时间的状态为$$i$$，那么它在下一个时刻的状态为$$j$$的概率是固定的，记为

$$
P(X_{n+1}=j\vert X_n=i)=P_{ij}
$$

那么称这个随机过程为马尔科夫过程。

$$P_{ij}$$代表的是从状态$$i$$转移到状态$$j$$的概率，所以也称为**转移概率**。
且有

$$
P_{ij}\geq 0;i,j\geq 0;\sum_{j=0}^{\infty}{P_{ij}}=1
$$

定义$$\mathbf{P}$$为马尔科夫过程的**单步转移矩阵**

$$
\mathbf{P}=\begin{vmatrix}
    P_{00}&P_{01}&P_{02}&\cdots\\
    P_{10}&P_{11}&P_{12}&\cdots\\
    \vdots&\vdots&\vdots&\\
    P_{i0}&P_{i1}&P_{i2}&\cdots\\
    \vdots&\vdots&\vdots
\end{vmatrix}
$$

### 查普曼-柯尔莫哥洛夫等式

我们定义了单步转移概率$$P_{ij}$$，我们现在定义一下$$n$$步转移概率

$$
P^{n}_{ij} = P(X_{n+k}=j\vert X_{k}=i),n\geq 0,i,j \geq 0
$$

查普曼-柯尔莫哥洛夫等式(Chapman-Kolmogorov Equation)提供了一种计算$$n$$步转移概率的方法。

$$
P^{n+m}_{ij} = \sum_{k=0}^{\infty}{P^{n}_{ik}P^{m}_{kj}},\forall m,n\geq 0;\forall i,j \geq 0
$$

很好证明：

$$
\begin{aligned}
    P^{n+m}_{ij} &= P(X_{m+n}=j\vert X_0=i)\\
    &=\sum_{k=0}^{\infty}{P(X_{m+n}=j,X_n=k\vert X_0=i)}\\
    &=\sum_{k=0}^{\infty}{P(X_{m+n}=j)\vert X_n=k,X_0=i}P{X_n=k\vert X_0=i}\\
    &=\sum_{k=0}^{\infty}{P^m_{kj}P^n_{ik}}
\end{aligned}
$$

与单步概率转移矩阵类似，如果我们令$$\mathbf{P}^{(n)}$$表示$$n$$步转移概率矩阵，那么查普曼-柯尔莫哥洛夫等式的矩阵形式就是

$$
\mathbf{P}^{(m+n)} = \mathbf{P}^{(m)}\mathbf{P}^{(n)}
$$

通过数学归纳法，我们可以得到下面这一个公式：

$$
\mathbf{P}^{(n)} = \mathbf{P}^n 
$$

好了，到目前为止我们讨论的概率都是条件概率，如果我们考虑在某一步处于某一状态的绝对概率，那么我们就要考虑初始状态的概率了，我们记：

$$
\alpha_i \equiv P(X_0=i),i\geq 0;\sum_{i=0}^{\infty}{\alpha_i} = 1
$$

那么$$X_n$$的概率分布就为：

$$
\begin{aligned}
    P(X_n=j) &=\sum_{i=0}^{\infty}{P(X_n=j\vert X_0=i)P(X_0=i)}\\
    &=\sum_{i=0}^{\infty}{P^{n}_{ij}\alpha_i}
\end{aligned}
$$

这里是一个[停时马尔科夫的例子]()

所以对于马尔科夫过程来说，最重要的是理清单步转移概率矩阵，通过查普曼-柯尔莫哥洛夫等式，得到相应的状态概率。

## 状态的分类

马尔科夫过程的状态的关系通过转移概率矩阵表示，通过转移概率矩阵，我们可以得到一些状态的性质。

我们说，状态$$j$$是状态$$i$$**可达的**，意味着对于某个$$n\geq 0$$，有$$P^n_{ij}>0$$，也就是说，我们说状态$$j$$可以从状态$$i$$达到，当且仅当从状态$$i$$开始，随机过程进入状态$$j$$的概率大于$$0$$，且记作$$i \rightarrow j$$

如果状态$$i$$可以到达状态$$j$$，同时状态$$j$$可以到达状态$$i$$，那么我们称状态$$i,j$$是**互通**的，记作$$i\leftrightarrow j$$，同时我们定义任意状态与它自身是互通的。

状态互通的三个性质：
1. 状态$$i$$与状态$$i$$互通（反身性）
2. 状态$$i$$与状态$$j$$互通，那么状态$$j$$与状态$$i$$互通（对称性）
3. 状态$$i$$与状态$$j$$互通,状态$$j$$与状态$$k$$互通，那么状态$$i$$与状态$$k$$互通（传递性）

我们说如果两个状态是互通的，那么它们属于同一**类**状态，因此互通这一关系，将状态空间分为了两类状态。如果一个马尔科夫过程的状态都满足互通关系，那么称这个马尔科夫过程为**不可约的**
（实际上，互通关系也是数学中很常见的等价关系，关于等价关系，几乎所有数学分支都有所涉及）

定义概率$$f_{ij}^{(n)}$$为从状态$$i$$出发，经过$$n$$步首次到达状态$$j$$的概率。

$$
\begin{aligned}
    &f_{ij}^{(0)}  = 0\\
    &f_{ij}^{(n)} = P(X_n=j,X_k\neq j,k=1,2,\cdots n-1 \vert X_0=i)\\
    &f_{ii} = \sum_{n=1}^{\infty}{f_{ii}^{(n)}}
\end{aligned}
$$

我们定义状态$$i$$是**常返**的，如果经过有限步，记做$$f_i=1$$，如果$$f_i < 1$$，则称状态为$$瞬过$$的

我们可以简单推理得到，如果一个马尔可夫过程从状态$$i$$开始，那么必定会再次重复这个过程

*定理*：

对于状态$$i$$

$$
\begin{aligned}
    \sum_{n=1}^{\infty}{P_{ii}^{n}} &= \infty,\text{则i是常返的}\\
    \sum_{n=1}^{\infty}{P_{ii}^{n}} &< \infty,\text{则i是瞬过的}\\
\end{aligned}

$$

*证明*：

该定理实际上是在说明，如果一个状态$$i$$是常返的，那么随机过程从状态$$i$$开始，处于状态$$i$$的期望次数是无穷的。
我们定义随机变量

$$
I_n = 
\begin{cases}
    1 & X_n = i\\
    0 & X_n \neq i\\
\end{cases}
$$

那么处于状态$$i$$的次数，我们可以表示成$$\sum_{n=1}^{\infty}{I_n}$$，那么

$$
\begin{aligned}
    E(\sum_{n=1}^{\infty}{I_n}\vert X_0=i) &= \sum_{n=1}^{\infty}{E(I_n\vert X_0=i)}\\
    &=\sum_{n=1}^{\infty}{P_{ii}^{n}}
\end{aligned}

$$

这个证明通常可以得到下面的结论：
如果一个有限状态马尔可夫过程，不可能所有的状态都是瞬过状态。

*推论*：

如果$$i$$是常返的，$$i$$和$$j$$是互通的，那么$$j$$也是常返的。

*证明*：

如果$$i$$与$$j$$是互通的，那么存在$$m$$,$$k$$，$$P_{ij}^{m}>0$$，$$P_{ji}^{k}>0$$对于任意整数$$n$$使得

$$
P_{jj}^{m+n+k} >= P_{ji}^{k}P_{ii}^{n}P_{ij}^{m} 
$$

因为从状态$$j$$到状态$$j$$，还有其他路径，经过$$i$$这只是一条路径。因此，两边对$$n$$求和

$$
\sum_{n=1}^{\infty}{P_{jj}^{m+n+k}} >= P_{ji}^{k}P_{ij}^{m} \sum_{n=1}^{\infty}{P_{ii}^{n}} = \infty
$$

所以，状态$$j$$也是常返态。
这个推论也可以推出，如果$$i$$是瞬过的，且$$i$$和$$j$$是互通的，那么$$j$$也是瞬过的。

总结一下，如果一个马尔可夫过程是有限状态，且状态间是互通的，那么所有状态都是常返态。

一个著名的随机例子，[醉汉回家](/)

## 极限概率