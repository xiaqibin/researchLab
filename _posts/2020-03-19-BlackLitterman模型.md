---
layout: post
title: BlackLitterman模型
category: [数学,金融]
description: 网络上关于BlackLitterman模型的中文讲解非常少，大多数只会照本宣科，按照Idzorek, Thomas M.(2004)大致翻译了一下，连案例都是一模一样，让我不得不想再次吐槽中文环境下的学术状况。不过幸运的是，在一篇券商研报中发现了对应的解释得比较清楚的文章，虽然也是基本照搬国外学者的文章翻译。
---
BlackLitterman模型是一个比较出名的资产配置模型，它是基于马可维茨的均值方差理论进行的改进，结合了CAPM，贝叶斯等理论，关键就是贝叶斯理论的应用。它解决了部分由直接均值方差优化带来的对输入期望收益敏感的问题，加入所谓的投资者先验知识，从而达到稳定最终输出权重的效果，从这个方面来看，BlackLitterman（简称BL）模型本质上是一个贝叶斯收缩方法。

## 基础前提

贝叶斯理论在统计学中很常见了，但是其具体应用一直是一个我不太能理解的点或者说不太懂怎么操作的方法。找个时间好好梳理一下，这里就不展开了，我们只需要知道贝叶斯条件概率公式

$$
P(B|A) = \frac{P(B)*P(A|B)}{P(A)}
$$

另外我们还需要知道马可维茨的均值方差理论的公式，均值方差理论的基础是最大化效用函数

$$
U = w^T\mu - \frac{\lambda}{2}w^t\Sigma w
$$

对上式子求导数

$$
\frac{\partial{U}}{\partial{w}} = \mu - \lambda \Sigma w = 0
$$

得到优化函数的解析解

$$
\mu = \lambda \Sigma w
$$

## BL模型

BL模型要求投资者对预期收益，预期收益的信心等进行设定，这可以看成是新增信息，因此就有先验预期收益，信息，后验预期收益三个概念，下面对这三个概念进行详细阐述

### 先验预期收益
所谓先验预期收益，从概念上来讲就是投资者什么信息都没有的情况下对市场上的资产的收益进行的估计。按照CAPM模型，市场均衡状态下，实际市值权重的资产组合就是所有投资者都持有的最优投资组合。因此我们可以反向推出在**市值权重**下的**市场预期均衡收益（市场收益率均值）**

$$
\Pi = \lambda \Sigma w_{mkt}
$$

这是BL模型的起点，因为市场均衡组合是以市值加权的，所以即使添加主观观点后，BL返回的权重也不会过于异常。

这里还有一个点需要注意一下，那就是风险厌恶系数$\lambda$的确定，使用CAPM公式的变形

$$
\lambda = \frac{E(r_m - r_f)}{\sigma_m^2}
$$

另一方面，**收益率均值**的协方差矩阵为$\tau \Sigma$，一般来说$\tau$十一个接近0的系数。因此资产收益率均值$\mu$可以记作

$$
\mu \sim N(\Pi,\tau\Sigma)
$$

我们用概率密度函数来表示

$$
\begin{equation}
P(\mu) = \frac{1}{\sqrt{(2\pi)^n\cdot \det(\tau\Sigma)}}\cdot \exp\left(-\frac{1}{2}(\mu-\Pi)^T\tau\Sigma(\mu-\Pi)\right)
\end{equation}
$$

记住$\mu$是收益率均值。

### 信息
我们这里的信息就是投资者对市场上的资产的观点。我们用矩阵$P$表示，如果投资组合中有$n$个资产，投资者发表了$k$个观点，那么观点矩阵$P$就是一个$k\times n$的矩阵，矩阵$P$中不包含主观收益率的任何信息，只是用$0$或者非$0$表示资产的权重。

对应$k$个观点，我们有$k$个预期收益，用向量$Q$表示。$P$和$Q$的数学形式为

$$
P\mu = Q + \epsilon
$$

$\epsilon$表示为均值是$0$，协方差矩阵为$\Omega$的误差项，假设各个观点间互不相关，$\Omega$为对角矩阵，因此有

$$
P\mu|\mu \sim N(Q,\Omega)
$$

概率密度函数形式为

$$
\begin{equation}
P(P\mu|\mu) = \frac{1}{\sqrt{(2\pi)^n\cdot \det(\Omega)}}\cdot \exp\left(-\frac{1}{2}(P\mu-Q)^T\Omega(P\mu-Q)\right)
\end{equation}
$$

### 后验预期收益

我们使用贝叶斯公式

$$
Pr(\mu|P\mu) = \frac{Pr(P\mu|\mu)\cdot Pr(\mu)}{Pr(P\mu)}
$$